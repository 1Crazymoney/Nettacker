info:
  id: admin-scan
  name: Divyansh
  author: y
  severity: z
  description: gg
  reference: oo
  tags:
    - scan
    - information_gathering
    - infortmation
    - info
    - domain

payloads:
  - library: http
    verify: false
    timeout: 3
    cert: ""
    stream: false
    proxies: ""
    steps:
      - method: get
        headers:
          User-Agent: "{user_agent}"
        url: "https://jldc.me/anubis/subdomains/{target}"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "\"([a-zA-Z0-9\\-\\_.\\s]+)\""
              reverse: false
      - method: post
        headers:
          User-Agent: "{user_agent}"
        url: "https://api.certspotter.com/v1/issuances?domain={target}&expand=dns_names&expand=issuer"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "\"([a-zA-Z0-9\\-\\_.\\s]+.{target})\""
              reverse: false
      - method: get
        headers:
          User-Agent: "{user_agent}"
        url: "https://www.threatcrowd.org/searchApi/v2/domain/report/?domain={target}"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "\"([a-zA-Z0-9\\-\\_.\\s]+.{target})\""
              reverse: false

      - method: get
        headers:
          User-Agent: "{user_agent}"
        url: "https://urlscan.io/api/v1/search/?q=domain:{target}"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "\"([a-zA-Z0-9\\-\\_.\\s]+.{target})\""
              reverse: false

      - method: get
        headers:
          User-Agent: "{user_agent}"
        url: "https://dns.bufferover.run/dns?q={target}"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "[a-zA-Z0-9\\-\\_.\\s]+\\.{target}"
              reverse: false

      - method: get
        headers:
          User-Agent: "{user_agent}"
        url: "https://otx.alienvault.com/api/v1/indicator/domain/{target}/passive_dns"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "[a-zA-Z0-9\\-\\_.\\s]+\\.{target}"
              reverse: false

      - method: get
        headers:
          User-Agent: "{user_agent}"
        url: "https://api.threatminer.org/v2/domain.php?q={target}&api=True&rt=5"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "[a-zA-Z0-9\\-\\_.\\s]+\\.{target}"
              reverse: false

      - method: get
        headers:
          User-Agent: "{user_agent}"
        url: "https://crt.sh/?q=%.{target}"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "[a-zA-Z0-9\\-\\_\\s]+[\\.]+[a-zA-Z0-9\\-\\_\\s]+\\.{target}"
              reverse: false
      - method: post
        headers:
          User-Agent: "{user_agent}"
        url: "https://hackertarget.com/find-dns-host-records/"
        data:
          theinput: "{target}"
          thetest: "hostsearch"
          name_of_nonce_field: "b4b6cc419d"
          "_wp_http_referer": "/find-dns-host-records/"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "^[2-3][0-9][0-9]"
              reverse: false
            content:
              regex: "[a-zA-Z0-9\\-\\_.]+\\.{target}"
              reverse: false

#      - method: get
#        headers:
#          User-Agent: "{user_agent}"
#        url: "https://dnsdumpster.com/"
#        response:
#          save_to_temp_events: "dnsdumpster_csrf_token_and_cookies"
#          condition_type: and
#          conditions:
#            status_code:
#              regex: "^[2-3][0-9][0-9]"
#              reverse: false
#
#      - method: post
#        headers:
#          User-Agent: "{user_agent}"
#          Referer: "https://dnsdumpster.com/"
#        url: "https://dnsdumpster.com/"
#        cookies:
#          csrftoken: csrf_middleware
#        data:
#          csrfmiddlewaretoken: csrf_middleware
#          targetip': "{target}"
#        response:
#          depend_on_temp_event: "dnsdumpster_csrf_token_and_cookies"
#          condition_type: and
#          conditions:
#            status_code:
#              regex: "^[2-3][0-9][0-9]"
#              reverse: false
#            content:
#              regex: "[a-zA-Z0-9\\-\\_\\s]+[\\.]+[a-zA-Z0-9\\-\\_\\s]+\\.{target}"
#              reverse: false

# todo: later
#      "subdomain_scan_use_dnsdumpster": ["True"],
#      "subdomain_scan_use_netcraft": [ "True" ],
#      "subdomain_scan_use_ptrarchive": [ "True" ],
#      "subdomain_scan_use_google_dig": [ "True" ],
#      "subdomain_scan_use_censys": [ "True" ],

